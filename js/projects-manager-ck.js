function make_projects_manager_image_removal(){jQuery(".has-image").hover(function(){jQuery(this).children("img.remove-image").fadeIn(100)},function(){jQuery(this).children("img.remove-image").fadeOut(100)});jQuery("img.remove-image").hover(function(){jQuery(this).next().addClass("steps-delete-hover")},function(){jQuery(this).next().removeClass("steps-delete-hover")});jQuery("img.remove-image").click(function(){jQuery(this).parent().removeClass("has-image");jQuery(this).next().attr("src","http://placehold.it/94x94").removeClass("steps-delete-hover").next().attr("value","");jQuery(this).remove()})}function make_projects_manager_sort_received(e){jQuery(e).hasClass("empty")&&jQuery(e).removeClass("empty").find(".empty").remove()}function make_projects_manager_sort_removed(e){jQuery(e).children().length==0&&jQuery(e).append($('<li class="empty">empty</li>')).addClass("empty")}function make_projects_manager_sort_stop(e){var t=jQuery("#sub-lists li:last img.add").length;if(t==0){jQuery("#sub-lists img.add").remove();jQuery("#sub-lists li:last").append('<img src="'+stylesheet_uri+'/images/icon-add.png" class="project-button add">')}}function make_projects_manager_add_list(){jQuery("#sub-lists img.add").click(function(){jQuery(this).remove();var e=jQuery("#sub-lists li").length-1;jQuery("#sub-lists .list-template").clone(!0).appendTo("#sub-lists").removeClass().find("textarea").attr({name:"lines[]",id:"line-"+e})})}function make_projects_manager_remove_list(){jQuery("#sub-lists img.remove").click(function(){jQuery(this).parent().remove();var e=jQuery("#sub-lists img.add").length;e===1&&jQuery("#sub-lists li:last").append('<img src="'+stylesheet_uri+'/images/icon-add.png" class="project-button add">')})}function make_projects_add_step(){}jQuery(document).ready(function(e){e("#image-list .has-image").prepend('<img src="'+stylesheet_uri+'/images/icon-remove.png" class="remove-image" />');make_projects_manager_image_removal();e("#sub-lists").sortable({connectWith:".sort",placeholder:"ui-state-highlight",receive:function(e,t){make_projects_manager_sort_received(this)},remove:function(e,t){make_projects_manager_sort_removed(this)},stop:function(e,t){make_projects_manager_sort_stop(this)}});make_projects_manager_add_list();make_projects_manager_remove_list()});(function(e){e(function(){e.fn.make_projects_manager=function(t){var n=e(this).selector,r={button:".steps-image",url:".image-url",preview:".steps-image"},t=e.extend(r,t),i=!0,s=wp.media.editor.send.attachment;e(t.button).click(function(){var n=e(this),r=e(this).siblings(t.url),o=wp.media.editor.send.attachment;i=!0;wp.media.editor.send.attachment=function(e,t){if(!i)return s.apply(this,[e,t]);r.val(t.url).trigger("change")};wp.media.editor.open(n);return!1});e(".add_media").on("click",function(){i=!1});e(t.url).bind("change",function(){var n=this.value,r=e(this).siblings(t.preview);e(r).attr("src",n);e(this).parent().addClass("has-image").prepend('<img src="'+stylesheet_uri+'/images/icon-remove.png" class="remove-image" />');make_projects_manager_image_removal()})};e(".image-upload").make_projects_manager()})})(jQuery);