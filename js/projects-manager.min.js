function make_projects_manager_add_list(){jQuery("#sub-lists img.add").click(function(){var e=jQuery(this).parents(".step-wrapper").children().val(),t=jQuery(this).parent().parent("#sub-lists").children().length+1,n=jQuery(".steps-template .list-template").clone(!0).removeClass("list-template");n.appendTo(jQuery(this).parent().parent("#sub-lists")).find("textarea").attr({id:"line-"+t,name:"step-lines-"+e+"[]"});jQuery(this).remove()})}function make_projects_manager_remove_list(){jQuery("#sub-lists img.remove").click(function(){var e=jQuery(this).parent().parent("#sub-lists");jQuery(this).parent().slideUp(500,function(){jQuery(this).remove();var t=e.find("img.add").length;t===0&&e.find("li:last").append('<img src="'+make_projects_js.stylesheet_uri+'/images/icon-add.png" class="project-button add">');make_projects_manager_add_list()})})}function make_projects_manager_image_removal(){jQuery(".has-image").hover(function(){jQuery(this).children("img.remove-image").fadeIn(100)},function(){jQuery(this).children("img.remove-image").fadeOut(100)});jQuery("img.remove-image").hover(function(){jQuery(this).next().addClass("steps-delete-hover")},function(){jQuery(this).next().removeClass("steps-delete-hover")});jQuery("img.remove-image").click(function(){jQuery(this).parent().removeClass("has-image");jQuery(this).next().attr("src","http://placehold.it/94x94").removeClass("steps-delete-hover").next().attr("value","");jQuery(this).remove()})}function make_projects_manager_sort_received(e){jQuery(e).hasClass("empty")&&jQuery(e).removeClass("empty").find(".empty").remove()}function make_projects_manager_sort_removed(e){jQuery(e).children().length===0&&jQuery(e).append($('<li class="empty">empty</li>')).addClass("empty")}function make_projects_manager_sort_updated(e){jQuery("#sub-lists img.add").remove();jQuery("#sub-lists li:last-child").append('<img src="'+stylesheet_uri+'/images/icon-add.png" class="project-button add">');make_projects_manager_add_list()}jQuery(document).ready(function(e){e("#make_magazine_projects_step_manager h3.hndle").prepend('<span class="steps-ico"></span>');e("#image-list .has-image").prepend('<img src="'+make_projects_js.stylesheet_uri+'/images/icon-remove.png" class="remove-image" />');make_projects_manager_image_removal();e("#sub-lists.sortable").sortable({connectWith:".sort",placeholder:"ui-state-highlight",axis:"y",receive:function(e,t){make_projects_manager_sort_received(this)},remove:function(e,t){make_projects_manager_sort_removed(this)},update:function(e,t){make_projects_manager_sort_updated(this)}}).disableSelection();make_projects_manager_add_list();make_projects_manager_remove_list();e(".add-step").click(function(){var t=e(".step-wrapper").length,n=e(".steps-template").clone(!0).removeClass("steps-template").addClass("hide").attr("id","step-"+t);e('input[name="total-steps"]').val(t);n.appendTo(e(this).parent()).slideDown().find(".step-title h3").html("Step "+t);e("#step-"+t+" li.list-template").removeClass();e("#step-"+t+' input[name="step-title-0"]').attr("name","step-title-"+t);e("#step-"+t+' > input[type="hidden"]').attr({name:"step-number-"+t,value:t});e("#step-"+t+" input.image-url").each(function(){e(this).attr("name","step-images-"+t+"[]")});e("#step-"+t+' textarea[name="step-lines-0[]"]').each(function(){e(this).attr({name:"step-lines-"+t+"[]",id:"line-"+t})})});e(".remove-step").click(function(){e(this).parent().parent().slideUp(500,function(){jQuery(this).remove();var t=0;e(".step-title h3").each(function(){e(this).html("Step "+t);t++});t=0;e(".inside .step .step-wrapper").each(function(){e(this).attr("id","step-"+t).children('input[type="hidden"]').attr({name:"step-number-"+t,value:t});t++});var n=e(".step-wrapper").length-1;e('input[name="total-steps"]').val(n)})})});(function(e){e(function(){e.fn.make_projects_manager=function(t){var n={button:".steps-image",url:".image-url",preview:".steps-image"},t=e.extend(n,t),r=!0,i=wp.media.editor.send.attachment;e(t.button).click(function(){var n=e(this),s=e(this).siblings(t.url),o=wp.media.editor.send.attachment;r=!0;wp.media.editor.send.attachment=function(e,t){if(!r)return i.apply(this,[e,t]);s.val(t.url).trigger("change")};wp.media.editor.open(n);return!1});e(".add_media").on("click",function(){r=!1});e(t.url).bind("change",function(){var n=this.value,r=e(this).siblings(t.preview);e(r).attr("src",n);e(this).parent().addClass("has-image").prepend('<img src="'+make_projects_js.stylesheet_uri+'/images/icon-remove.png" class="remove-image" />');make_projects_manager_image_removal()})};e(".image-upload").make_projects_manager()})})(jQuery);